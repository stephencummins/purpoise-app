# Excel Uploader - Power Apps Canvas App
# This YAML represents the app structure for reference/recreation
# Import this concept into Power Apps Studio

App:
  Name: Excel Uploader
  Description: Upload Excel files to SharePoint with automated processing
  Theme: Microsoft Teams

Screens:
  - Name: MainScreen
    Fill: RGBA(245, 245, 245, 1)

    Controls:
      - Name: HeaderContainer
        Type: Container
        X: 0
        Y: 0
        Width: Parent.Width
        Height: 80
        Fill: RGBA(0, 120, 212, 1)

        Children:
          - Name: AppTitle
            Type: Label
            X: 20
            Y: 20
            Width: 300
            Height: 40
            Text: "Excel Uploader"
            Color: White
            Font: Segoe UI Semibold
            Size: 24

      - Name: MainContainer
        Type: Container
        X: 40
        Y: 120
        Width: Parent.Width - 80
        Height: Parent.Height - 160

        Children:
          - Name: InstructionLabel
            Type: Label
            X: 0
            Y: 0
            Width: Parent.Width
            Height: 40
            Text: "Select an Excel file (.xlsx) to upload"

          - Name: FileAttachment
            Type: Attachments
            X: 0
            Y: 50
            Width: 400
            Height: 100
            MaxAttachments: 1
            Accept: ".xlsx"

          - Name: UploadButton
            Type: Button
            X: 0
            Y: 170
            Width: 200
            Height: 45
            Text: "Upload Excel"
            Fill: RGBA(0, 120, 212, 1)
            Color: White
            OnSelect: |
              // See PowerFx_Formulas.txt for full formula

          - Name: ProgressBar
            Type: Slider
            X: 0
            Y: 230
            Width: 400
            Height: 20
            Visible: varUploading
            Value: varProgress

          - Name: StatusMessage
            Type: Label
            X: 0
            Y: 270
            Width: Parent.Width
            Height: 60
            Text: varStatusMessage
            Color: |
              If(varIsError,
                RGBA(164, 38, 44, 1),  // Red for error
                RGBA(16, 124, 16, 1)   // Green for success
              )

      - Name: RecentUploadsGallery
        Type: Gallery
        X: 40
        Y: 360
        Width: Parent.Width - 80
        Height: 300
        Items: |
          Sort(
            Filter(ExcelUploads, CreatedBy.Email = User().Email),
            Created,
            SortOrder.Descending
          )
        TemplateFill: RGBA(255, 255, 255, 1)

        Template:
          - Name: FileNameLabel
            Type: Label
            Text: ThisItem.Name
          - Name: UploadDateLabel
            Type: Label
            Text: Text(ThisItem.Created, "dd/mm/yyyy hh:mm")
          - Name: StatusIcon
            Type: Icon
            Icon: |
              If(ThisItem.Status = "Processed",
                Icon.CheckMark,
                Icon.Clock
              )

DataSources:
  - Name: ExcelUploads
    Type: SharePoint
    Site: "https://yourtenant.sharepoint.com/sites/YourSite"
    List: ExcelUploads

  - Name: PowerAutomateFlow
    Type: PowerAutomateFlow
    FlowName: Excel Uploader Flow

Variables:
  - Name: varUploading
    Type: Boolean
    Default: false

  - Name: varProgress
    Type: Number
    Default: 0

  - Name: varStatusMessage
    Type: Text
    Default: ""

  - Name: varIsError
    Type: Boolean
    Default: false

  - Name: varSelectedFile
    Type: Record
    Default: Blank()
